---
layout: essay
type: essay
title: Phase Transition in Ferromagnetic Simulation and Experiment
date: 2016-12-05
labels:
  - Ising model
  - simulation
  - phase transition
  - ferromagnet
  - paramagnet
---
PDF : [Phase Transition in Ferromagnetic Simulation and Experiment](ising.pdf "ising PDF")
<p align="center">
Abstract
<p align="justify">
 A program is written that implements a 3-dimensional Ising model and the Metropolis algorithm to simulate the phase transition of a ferromagnet to a paramagnet. Vanishing magnetization and a discontinuity in the average energy for simulated data is observed at the Curie temperature. Simulated data compared to experimental measurements of CoNiFeCB magnetization as a function of temperature shows that the simulation approaches the Curie temperature quicker. The Curie temperature for CoNiFeCB is measured to be approximately 600&nbsp;&deg;C .  <br> <br>





   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 37--><p class="noindent" >  <p align="justify"> Ferromagnetic materials posses a spontaneous magnetic moment which arises from the regular arrangement of their electron spins. In a ferromagnet the unpaired electrons arrange their
alignments parallel to one another within domains separated by so-called Bloch walls. The most well known ferromagnetic materials are iron, nickel and cobalt. Upon application of a magnetic field to a ferromagnetic sample, the domains will align and the material is said to be magnetized. Curiously, if a ferromagnetic sample is heated above a certain critical temperature, the sample&#8217;s magnetization disappears; this temperature is the Curie temperature. The phase transition that takes place at the Curie temperature is from spin aligned ferromagnetism to disordered
paramagnetism. <span class="cite">[<a  href="#Xss">1</a>]</span><span class="cite">[<a 
href="#Xlandau">2</a>]</span> 
<!--l. 40--><p class="indent" >   <p align="justify"> 
An interesting application for ferromagnetic materials may be found in electronics such as in ferroelectric random access memory for computers (FeRAM). <span class="cite">[<a  href="#Xferam">3</a>]</span> From these points of interest, we aim to understand and model the phase transition at the Curie temperature that characterize ferromagnetic samples. In this study we simulate the thermodynamic effects on spin in a ferromagnet and compare the simulation to data collected from a CoNiFeCB sample consisting of measurements of magnetization as a function of temperature.

<center><img class="spin distribution equilibrating" src="../images/spinup.png" width="540"> </center><br>
Figure 1: A 3D lattice of 100 spins initially aligned spin-up. Spin up states are denoted with
circles and down states are shown as blank areas. Domains begin to form as the system
equilibrates. <span class="cite">[<a 
href="#Xlandau">2</a>] <br> <br>

<!--l. 51--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Description of simulation &amp; algorithm</h3>
<!--l. 52--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-30002.1"></a>Ising model</h4>
<!--l. 53--><p class="noindent" > <p align="justify">   The mathematical model of ferromagnetism we use is the Ising model which takes a <span 
class="cmmi-12">Z</span>
dimensional lattice and statically represents an atomic spin at each vertex. We will use a
3-dimensional model. Since the particles are fixed at each vertex, we need not be concerned with
the Pauli exclusion principle implying the antisymmetry of the wave function since no particles
may be exchanged in this system. A particle&#8217;s initial state is denoted <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">i</span></sub> and may be either spin-up
or spin-down as shown by the following relation. <span class="cite">[<a 
href="#Xlandau">2</a>]
<br>

<html>
<head>
<title>MathJax TeX Test Page</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
$$s_i \equiv s_{z,i} = \pm \frac{1}{2} $$
</body>
</html>
<p align="right"> (1)

<br> <p align="justify"> Were <span 
class="cmmi-12">s </span>is spin, <span 
class="cmmi-12">z </span>just denotes the
axis that the spin is directed along, and <img 
src="ising1x.png" alt="1
2"  class="frac" align="middle"> is the value of the electron spin. If there are <span 
class="cmmi-12">N </span>particles in this system, the total number of possible states is 2<sup><span 
class="cmmi-8">N</span></sup>. Thus, the ket vector for this system
is

<html>
<head>
<title>MathJax TeX Test Page</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
$$|{s_j}\rangle = |{s_1, s_2, s_3, ..., s_N}\rangle, \textrm{} j = 1, 2^N$$
</body>
</html>
<p align="right"> (2)

<p class="indent" >  <p align="justify">  Furthermore, we may model the spin-spin interaction as a dipole-dipole interaction as known from quantum mechanics. From solid state physics we know that spins interact with their immediate neighbor, with the exchange field, and the external magnetic field. Thus we have the following potential
<html>
<head>
<title>MathJax TeX Test Page</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
$$V_i = -J \vec{s_i} \cdot \vec{s_{i+1}} - g \mu_b \vec{s_i} \cdot \vec{B}$$
</body>
</html>
<p align="right"> (3)


<br> <p align="justify"> Here, <span 
class="cmmi-12">V </span>is the potential for some state <span 
class="cmmi-12">i</span>, <span 
class="cmmi-12">J </span>is the exchange energy
which is the strength of spin-spin interaction, <span 
class="cmmi-12">g </span>and <span 
class="cmmi-12">&mu;</span><sub><span 
class="cmmi-8">b</span></sub> is the gyromagnetic ratio constant and the
Bohr magneton respectively, and <span 
class="cmmi-12">s </span>denotes, as usual, spin.<br>
<!--l. 66--><p class="indent" >   <p align="justify"> Due to the extremely large number of particles in systems such as this, usually given as
10<sup><span 
class="cmr-8">23</span></sup> particles, statistical methods are necessary. The Ising model uses the Boltzmann
distribution to obtain the probabilistic energy of the system, and is given in equation
(4).
 <html>
<head>
<title>MathJax TeX Test Page</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
$$P(s_j) = \frac{e^{-E(s)/kT}}{\sum_{sj} e^{-E_j/kT}}$$
</body>
</html>
<p align="right"> (4)
                                                                                        
<!--l. 70--><p class="indent" > <p align="justify">  Above, <span 
class="cmmi-12">P </span>represents probability, <span 
class="cmmi-12">E </span>denotes energy, and <span 
class="cmmi-12">k </span>and <span 
class="cmmi-12">T </span>is Boltzmann&#8217;s constant and
temperature respectively. The Boltzmann distribution says that states with lower energy are more
likely to occur, while states with higher energy are possible, yet have less probability to occur. The
energy of the system to be applied to equation (4) is given by the expectation value
of (3) over all states of the system, which is shown in the following equation. <span class="cite">[<a 
href="#Xlandau">2</a>]</span> <span class="cite">[<a 
href="#Xising">4</a>]

<html>
<head>
<title>MathJax TeX Test Page</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
$$E(s) = \langle s | \sum \limits_i V_i |s \rangle = -J \sum \limits_{i=1}^{N-1} s_i s_{i+1} - B \mu_b \sum \limits_{i=1}^{N} s_i$$
</body>
</html>
<p align="right"> (5)


<!--l. 74--><p class="indent" > <p align="justify"> 
  An interesting outcome of the Boltzmann distribution which one can see in figure (1) and
which we will see more of below, is that there is no single configuration of lowest energy.
The statistical nature of the thermodynamics which effect the spin arrangements are
constantly randomly exchanging via thermal energy and the exchange field. A written
C++ program implements the Ising model in three dimensions by randomly flipping the
spin of dipole arrangements in the lattice points of a cube. After a random number
generator is seeded with number 94180717 the program is run and a loop randomly
determines spin-up or spin-down and calculates the energy based on equation (5). The
program determines lowest energy, and a three dimensional map of spin-up states is
output.
<!--l. 76--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-40002.2"></a>Metropolis algorithm</h4>
<!--l. 77--><p class="noindent" >  <p align="justify">   The Metropolis algorithm is similar to Monte Carlo methods, but extends it to essentially be a Markov chain Monte Carlo which allows one to apply it to the Boltzmann distribution. The notion of the Metropolis algorithm is that the arrangements of the spins which randomly alternate between spin-up and spin-down due to thermodynamics, are processed via the variance reduction method and the von Neumann reduction technique. The variance reduction method reduces computation time by obtaining a minimum variance between functions so that integration may be solved quicker than when considering the set of smaller and larger variances combined. The von Neumann rejection technique generates random points in a probability distribution and counts only those point that fall within the desired weighting function. 
<span class="cite">[<a 
href="#Xlandau">2</a>]</span>

<!--l. 80--><p class="indent" >  <p align="justify">   The outline of the Metropolis algorithm is the following. First, initial temperature and configuration of all states beginning in spin-up in the 3-dimensional lattice is set and the algorithm runs until the system reaches equilibrium. Next, a particle is chosen randomly and its spin is flipped, this generates a statistically random configuration of which we may calculate thermodynamic quantities such as magnetization and internal energy. After energy is calculated, the following conditionals are the main parts of this algorithm. If <span 
class="cmmi-12">E</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">trial</span></sub>) <span 
class="cmsy-10x-x-120">&le; </span><span 
class="cmmi-12">E</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">j</span></sub>)<span 
class="cmmi-12">, </span>then accept
and set <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">j</span><span 
class="cmr-8">+1</span></sub> = <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">trial</span></sub>. If <span 
class="cmmi-12">E</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">trial</span></sub>) <span 
class="cmmi-12">&#x003E; E</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">j</span></sub>)<span 
class="cmmi-12">, </span>then accept with relative probability <span 
class="cmmi-12">P </span>= <span 
class="cmmi-12">e</span><sup><span 
class="cmsy-8">&minus;</span><span 
class="cmr-8">&Delta;</span><span 
class="cmmi-8">E&#x2215;kT</span> </sup>.
Within this last step, another random number between 0 and 1 is generated and compared to the
probability just obtained. If the random number is less than or equal to the probability, the spin
state is accepted and set to <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">j</span><span 
class="cmr-8">+1</span></sub>, and if the probability is less than the random number,
the state is rejected. The key to the Metropolis algorithm is that states that are not
lowest energy are not simply thrown away because that is not how thermodynamic
statistical systems work. The states with higher energy are run through the second
conditional and determined whether it is accepted to rejected, which shows that higher
energy states although less probable are still kept to a statistical degree in the system.
<span class="cite">[<a 
href="#Xlandau">2</a>]</span>
<!--l. 82--><p class="indent" >  <p align="justify">   A C++ program written by the author based off of the outline given above implements the Metropolis algorithm and a 3-dimensional Ising model. The source code is freely available upon request. The program is run for various temperatures thereby obtaining the temperature dependence of the spin system.
<!--l. 84--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>Experiment</h3>
<!--l. 85--><p class="noindent" >  <p align="justify">   This semester the author has been granted an Undergraduate Research Opportunity through the University of Hawaii at Manoa (UROP) for the project: Magnetization characterization of
novel multiferroic materials, dependence of particle size, temperature, strength and gradient of magnetic field. A summary of the experimental set up is given here. Measurements of thermo-magnetic properties are conducted using Faraday&#8217;s balance method in an external non-uniform magnetic field. Direct current power supply provides current for a solenoid which induces a time constant magnetic field. The ferrite sample is placed in the measurement position
and lowered into the solenoid by use of a custom-made high temperature resistant dielectric diamagnetic holder. The measurement of the magnetic field is done by a high precision balance, the Sartorius Entris 64-1S.
<!--l. 88--><p class="indent" >   <p align="justify">  During the complete duration of measurement while the sample is in the magnetic field, temperature is monitored with a high precision electronic thermometer and using a high
temperature resistant thermocouple. Magnetization is measured up to 900K in steps of 20K. The
sample is heated in a custom made electric oven where a variable transformer is used to provide
power to the oven which enables excellent control over the heating rate. Controlling the heating
rate is important since the temperature gradient is one of the parameters which strongly influence
the magnetization of the sample.
<!--l. 90--><p class="indent" >   <p align="justify">  The goal of the UROP experiment is to measure the magnetic and electric properties of several
ferroic materials as a function of temperature and particle size. The aim is to find the optimal
compound mixture and thermal preparation, and to establish the relationship between composition
and thermal treatment compared to material performance. The initial compound of CoNiFeCB is
measured and discussed in this paper, with more samples to be measured in the Spring of 2017.
<span class="cite">[<a 
href="#Xprop">5</a>]</span>
<!--l. 114--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-60004"></a>Discussion</h3>
                                                                                         
                                                                                         
<!--l. 115--><p class="noindent" >   <p align="justify">  The 3-dimensional model compared to the 1-dimensional case results in less fluctuation of spins
due to an increase of couplings to nearest neighbor and thus an increase in thermal inertia.<span class="cite">[<a 
href="#Xlandau">2</a>]</span> An
important aspect of the program is the periodic boundary conditions which are conditionals that
keep track of on-going loop summations in the three dimensional array to the boundaries
within the cubic structure. The total number of particles, <span 
class="cmmi-12">N</span>, applied in the program is
2000.
<!--l. 118--><p class="indent" >  <p align="justify">   Figures (2), (3a), and (3b) show simulation results from the 3-dimensional Ising
model and the Metropolis algorithm for magnetization, specific heat, and susceptibility
respectively. In thermodynamics, temperature is often expressed as proportional to <span 
class="cmmi-12">kT</span>,
where <span 
class="cmmi-12">k </span>is Boltzmann&#8217;s constant and <span 
class="cmmi-12">T </span>is temperature; in the plots we express <span 
class="cmmi-12">kT </span>as
<span 
class="cmsy-10x-x-120">&prop; </span><span 
class="cmmi-12">T</span>.

<center><img class="spin distribution equilibrating" src="../images/ising1.png" width="540"> </center><br>
Figure 2: Magnetization as a function of temperature in simulation with the 3D Ising model and the Metropolis algorithm. Note the Curie temperature is observed approximately proportional to 4.5 K, and also relates to the peaks found in figures (3a) and (3b). <br> <br>
<center><img class="spin distribution equilibrating" src="../images/ising2c.png" width="540"> </center><br>
<center><img class="spin distribution equilibrating" src="../images/ising2b.png" width="540"> </center><br>
Figure 3: (a) Specific heat as a function of temperature from simulation results. (b) Susceptibility as a function of temperature.

<!--l. 136--><p class="indent" >  <p align="justify">   Phase transition is clearly observed as shown in figure (2) from the ferromagnetic case to
paramagnetic. Magnetization vanishes at approximately a temperature proportional to 4.5 K. The
specific heat and susceptibility also show peaks at the Curie temperature. Interestingly, specific
heat and susceptibility peak for a certain width around the Curie temperature then as temperature
increases, the values for the function fall back down to zero. This shows that when the Curie
temperature is met, the configuration of paramagnetic disordered states have a maximum value for
specific heat and susceptibility.
<!--l. 138--><p class="indent" >   <p align="justify">  Figure (4) plots the average energy of the system. As temperature in the simulation is
increased, energy increases with a discontinuity in the increasing slope being observed at
approximately a temperature proportional to 4.4 K. This discontinuity also corresponds to the
Curie temperature.
<center><img class="spin distribution equilibrating" src="../images/ising3.png" width="540"> </center><br>
Figure 4: The average energy of the system as a function of temperature from the simulation.
<!--l. 140--><p class="indent" >  <p align="justify">   Measured magnetization from a CoNiFeCB sample as a function of temperature is plotted in
figure (5) and compared to a scaled plot of the simulation results for magnetization. The
simulation compared to data have overall a similar shape, although the rate of decrease in
magnetization is quicker in the simulation rather than in the CoNiFeCB sample. This may be
because the sample we are working with is not a pure ferromagnet. If the sample only included, say
Fe, one would expect a better fit between data and simulated results. An interesting point to note
is that after magnetization reaches a minimum, in both cases a slight increase in magnetization is
observed. Data should be taken in an extended temperature region with the CoNiFeCB
sample to see if the slight increase in magnetization after <span 
class="cmmi-12">&#x00A0;</span>600&#x00A0;<sup><span 
class="cmsy-8">&#x2218;</span></sup>C reduces back down to
minimum.
<center><img class="spin distribution equilibrating" src="../images/ising4.png" width="540"> </center><br>
Figure 5: Simulation results compared to experimental data measuring magnetization of CoNiFeCB as a function of temperature.
<!--l. 142--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-70005"></a>Conclusion</h3>
<!--l. 143--><p class="noindent" >  <p align="justify">   A 3-dimensional Ising model with the Metropolis algorithm is successfully implemented in a
C++ program, and simulation of the phase transition of a ferromagnet at high temperature is
observed. The Curie temperature is also observed as a discontinuity in the total average energy of
the system as temperature increases and as peaks in specific heat and susceptibility in the
simulated data. Magnetization simulation is compared to measured data from CoNiFeCB as a
function of temperature. Shapes between functions of simulation and data show the simulation
                                                                                         
                                                                                         
approaches the Curie temperature quicker than our experimental measurements. This is
most likely because the ferromagnetic sample we are using, CoNiFeCB, is not a pure
ferromagnet.
<!--l. 147--><p class="noindent" >
   <h4 class="likesubsectionHead"><a 
 id="x1-80005"></a>Acknowledgement</h4>
<!--l. 148--><p class="noindent" >   <p align="justify">  Special thanks to Dr.Gorham for working with the author during a time which the Phys305
course is usually not offered. Also, many thanks to Dr.Radovan Milincic, Dr.Jelena Maricic, and
the University of Hawaii at Manoa for giving me the opportunity to work on the experiment
of ferroic material properties as a function of temperature and enabling the UROP
grant.
<!--l. 153--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-90005"></a>References</h3>
<!--l. 153--><p class="noindent" >
     <div class="thebibliography">
     <p class="bibitem" ><span class="biblabel">
  [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xss"></a>Charles Kittel. Introduction to Solid State Physics. Wiley, 1971. pg. 529.
     </p>
     <p class="bibitem" ><span class="biblabel">
  [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xlandau"></a>Rubin  Landau,  Manuel  Paez,  and  Cristian  Bordeianu.  Computational  Physics,
     problem solving with computers. Wiley, 2013. pg. 165-178, 157-158, 162.
     </p>
     <p class="bibitem" ><span class="biblabel">
  [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xferam"></a>W.Eerenstein,  N.D.Mathur,  and  J.F.Scott.  Multifferroic  and  magnetoelectric
     materials. Nature, Vol442, August 2006. pg. 759-765.
     </p>
     <p class="bibitem" ><span class="biblabel">
  [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xising"></a>Timothy Gowers, June Barrow-Green, and Imre Leader. The Princeton Companion
     to Mathematics. Princeton University Press, 2010. pg. 666.
     </p>
     <p class="bibitem" ><span class="biblabel">
  [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xprop"></a>Radovan Milincic, and Christina Nelson. Magnetization characterization of novel
     multiferroic materials: dependence of particle size, temperature, strength, and gradient
     of magnetic field. UROP proposal 2016.
                                                                                         
                                                                                         
     </p>
     <p class="bibitem" ><span class="biblabel">
  [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmet"></a>Nicholas  Metropolis,  Arianna  Rosenbluth,  Marshall  Rosenbluth,  Augusta  Teller.
     Equation of State Calculations by Fast Computing Machines. 1953. The Journal of
     Chemical Physics, Vol.21, No.6.
</p>
     </div>
    

                                                                                         


